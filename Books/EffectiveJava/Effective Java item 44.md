# Effective Java item 44



### ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λΌ



μλ°”κ°€ λλ‹¤λ¥Ό μ§€μ›ν•λ©΄μ„ APIλ¥Ό μ‘μ„±ν•λ” λ¨λ²” μ‚¬λ΅€λ„ ν¬κ² λ°”λ€μ—λ‹¤. μμ»¨λ€ μƒμ„ ν΄λμ¤μ κΈ°λ³Έ λ©”μ„λ“λ¥Ό μ¬μ •μν•΄ μ›ν•λ” λ™μ‘μ„ κµ¬ν„ν•λ” ν…ν”λ¦Ώ λ©”μ„λ“ ν¨ν„΄μ λ§¤λ ¥μ΄ ν¬κ² μ¤„μ—λ‹¤. μ΄λ¥Ό λ€μ²΄ν•λ” ν„λ€μ μΈ ν•΄λ²•μ€ κ°™μ€ ν¨κ³Όμ ν•¨μ κ°μ²΄λ¥Ό λ°›λ” μ •μ  ν©ν† λ¦¬λ‚ μƒμ„±μλ¥Ό μ κ³µν•λ” κ²ƒμ΄λ‹¤.

:notebook_with_decorative_cover: μ΄ λ‚΄μ©μ„ μΌλ°ν™” ν•΄μ„ λ§ν•λ©΄ ν•¨μ κ°μ²΄λ¥Ό λ§¤κ°λ³€μλ΅ λ°›λ” μƒμ„±μμ™€ λ©”μ„λ“λ¥Ό λ” λ§μ΄ λ§λ“¤μ–΄μ•Ό ν•λ‹¤. μ΄λ• ν•¨μν• λ§¤κ°λ³€μ νƒ€μ…μ„ μ¬λ°”λ¥΄κ² μ„ νƒν•΄μ•Ό ν•λ‹¤.



- LinkedHashMapμ„ μƒκ°ν•΄λ³΄μ. μ΄ ν΄λμ¤μ protected λ©”μ„λ“μΈ removeEldestEntryλ¥Ό μ¬μ •μν•λ©΄ μΊμ‹λ΅ μ‚¬μ©ν•  μ μλ‹¤. λ§µμ— μƒλ΅μ΄ ν‚¤λ¥Ό μ¶”κ°€ν•λ” put λ©”μ„λ“λ” μ΄ λ©”μ„λ“λ¥Ό νΈμ¶ν•μ—¬ trueκ°€ λ°ν™λλ©΄ λ§µμ—μ„ κ°€μ¥ μ¤λλ μ›μ†λ¥Ό μ κ±°ν•λ‹¤. μμ»¨λ€ removeEldestEntryλ¥Ό λ‹¤μμ²λΌ μ¬μ •μν•λ©΄ λ§µμ— μ›μ†κ°€ 100κ°κ°€ λ  λ•κΉμ§€ μ»¤μ§€λ‹¤κ°€, κ·Έ μ΄μƒμ΄ λλ©΄ μƒλ΅μ΄ ν‚¤κ°€ λ”ν•΄μ§ λ•λ§λ‹¤ κ°€μ¥ μ¤λλ μ›μ†λ¥Ό ν•λ‚μ”© μ κ±°ν•λ‹¤. μ¦‰, κ°€μ¥ μµκ·Ό μ›μ† 100κ°λ¥Ό μ μ§€ν•λ‹¤.

```java
protected boolean removeEldestEntry(Map.Entry<K, V> eldest) {
    return size() > 100;
}
```

μ λ™μ‘ν•μ§€λ§ λλ‹¤λ¥Ό μ‚¬μ©ν•λ©΄ ν›¨μ”¬ μ ν•΄λ‚Ό μ μλ‹¤. LinkedHashMapμ„ μ¤λλ‚  λ‹¤μ‹ κµ¬ν„ν•λ‹¤λ©΄ ν•¨μ κ°μ²΄λ¥Ό λ°›λ” μ •μ  ν©ν„°λ¦¬λ‚ μƒμ„±μλ¥Ό μ κ³µν–μ„ κ²ƒμ΄λ‹¤.



```java
// λ¶ν•„μ”ν• ν•¨μν• μΈν„°νμ΄μ¤ - λ€μ‹  ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λΌ.
@FunctionalInterface
interface EldestEntryRemovalFunction<K, V> {
    boolean remove(Map<K, V> map, Map.Entry<K, V> eldest);
}
```

μ΄ μΈν„°νμ΄μ¤λ„ μ λ™μ‘ν•κΈ°λ” ν•μ§€λ§, κµ³μ΄ μ‚¬μ©ν•  μ΄μ λ” μ—†λ‹¤. μλ°” ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬μ— μ΄λ―Έ κ°™μ€ λ¨μ–‘μ μΈν„°νμ΄μ¤κ°€ μ¤€λΉ„λμ–΄ μκΈ° λ•λ¬Έμ΄λ‹¤. java.util.function ν¨ν‚¤μ§€λ¥Ό λ³΄λ©΄ λ‹¤μ–‘ν• μ©λ„μ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤κ°€ λ‹΄κ²¨ μλ‹¤.

β­ **ν•„μ”ν• μ©λ„μ— λ§λ” κ² μλ‹¤λ©΄, μ§μ ‘ κµ¬ν„ν•μ§€ λ§κ³  ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό ν™μ©ν•λΌ.**



- java.util.function ν¨ν‚¤μ§€μ—λ” μ΄ 43κ°μ μΈν„°νμ΄μ¤κ°€ λ‹΄κ²¨ μλ‹¤. λ‹¤μμ€ μ΄ κΈ°λ³Έ ν•¨μν• μΈν„°νμ΄μ¤λ“¤μ„ μ •λ¦¬ν• ν‘λ‹¤.

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fyewkl%2FbtqFZ4QCXVL%2Fu9zSr3UGUjPHgkxnSK6tAk%2Fimg.jpg" />

- ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ” μ΄ 43κ°λ‹¤. μ†”μ§ν λ‹¤ μ™Έμ°κΈ°μ—” μλ„ λ§κ³  κ·μΉ™μ„±λ„ λ¶€μ΅±ν•λ‹¤. ν•μ§€λ§ μ‹¤λ¬΄μ—μ„ μμ£Ό μ“°μ΄λ” ν•¨μν• μΈν„°νμ΄μ¤ μ¤‘ μƒλ‹Ήμλ¥Ό μ κ³µν•λ©°, ν•„μ”ν•  λ• μ°Ύμ•„ μ“Έ μ μμ„ λ§νΌμ€ λ²”μ©μ μΈ μ΄λ¦„μ„ μ‚¬μ©ν–λ‹¤.
- ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤ λ€λ¶€λ¶„μ€ κΈ°λ³Έ νƒ€μ…λ§ μ§€μ›ν•λ‹¤. κ·Έλ ‡λ‹¤κ³  **κΈ°λ³Έ ν•¨μν• μΈν„°νμ΄μ¤μ— λ°•μ‹±λ κΈ°λ³Έ νƒ€μ…μ„ λ„£μ–΄ μ‚¬μ©ν•μ§€λ” λ§μ.** λ™μ‘μ€ ν•μ§€λ§ "λ°•μ‹±λ κΈ°λ³Έ νƒ€μ… λ€μ‹  κΈ°λ³Έ νƒ€μ…μ„ μ‚¬μ©ν•λΌ"λΌλ” μ΅°μ–Έμ„ μ„λ°°ν•λ‹¤. νΉν κ³„μ‚°λ‰μ΄ λ§μ„ λ•λ” μ„±λ¥μ΄ μ²μ°Έν λλ ¤μ§ μ μλ‹¤.



:notebook_with_decorative_cover: μ΄μ  λ€λ¶€λ¶„ μƒν™©μ—μ„λ” μ§μ ‘ μ‘μ„±ν•λ” κ²ƒλ³΄λ‹¤ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λ” νΈμ΄ λ‚μμ„ μ•μ•μ„ κ²ƒμ΄λ‹¤. κ·Έλ ‡λ‹¤λ©΄ μ½”λ“λ¥Ό μ§μ ‘ μ‘μ„±ν•΄μ•Ό ν•  λ•λ” μ–Έμ μΈκ°€? λ¬Όλ΅  ν‘μ¤€ μΈν„°νμ΄μ¤ μ¤‘ ν•„μ”ν• μ©λ„μ— λ§λ” κ² μ—†λ‹¤λ©΄ μ§μ ‘ μ‘μ„±ν•΄μ•Ό ν•λ‹¤. λν• κµ¬μ΅°μ μΌλ΅ λ‘κ°™μ€ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤κ°€ μλ”λΌλ„ μ§μ ‘ μ‘μ„±ν•΄μ•Όλ§ ν•  λ•κ°€ μλ‹¤.

- μμ£Ό λ³΄μ•„μ¨ Comparator<T> μΈν„°νμ΄μ¤λ¥Ό λ– μ¬λ ¤ λ³΄μ. κµ¬μ΅°μ μΌλ΅λ” ToIntBiFunction<T, U>μ™€ λ™μΌν•λ‹¤. μ‹¬μ§€μ–΄ μλ°” λΌμ΄λΈλ¬λ¦¬μ— Comparator<T>λ¥Ό μ¶”κ°€ν•  λ‹Ήμ‹ ToIntBiFunction<T, U>κ°€ μ΅΄μ¬ν–λ”λΌλ„ ToIntBiFunction<T, U>λ¥Ό μ‚¬μ©ν•λ©΄ μ•λλ‹¤.

1. APIμ—μ„ κµ‰μ¥ν μμ£Ό μ‚¬μ©λλ”λ°, μ§€κΈμ μ΄λ¦„μ΄ κ·Έ μ©λ„λ¥Ό μ•„μ£Ό ν›λ¥­ν μ„¤λ…ν•΄μ¤€λ‹¤.
2. κµ¬ν„ν•λ” μ½μ—μ„ λ°λ“μ‹ μ§€μΌμ•Ό ν•  κ·μ•½μ„ λ‹΄κ³  μλ‹¤.
3. λΉ„κµμλ“¤μ„ λ³€ν™ν•κ³  μ΅°ν•©ν•΄μ£Όλ” μ μ©ν• λ””ν΄νΈ λ©”μ„λ“λ“¤μ„ λ“¬λΏ λ‹΄κ³  μλ‹¤.



β΅ μ΄μƒμ Comparator νΉμ„±μ„ μ •λ¦¬ν•λ©΄ λ‹¤μμ μ„Έκ°€μ§€μΈλ°, μ΄ μ¤‘ ν•λ‚ μ΄μƒμ„ λ§μ΅±ν•λ‹¤λ©΄ μ „μ© ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•΄μ•Ό ν•λ” κ±΄ μ•„λ‹μ§€ μ§„μ¤‘ν κ³ λ―Όν•΄μ•Ό ν•λ‹¤.

1. μμ£Ό μ“°μ΄λ©°, μ΄λ¦„ μμ²΄κ°€ μ©λ„λ¥Ό λ…ν™•ν μ„¤λ…ν•΄μ¤€λ‹¤.
2. λ°λ“μ‹ λ”°λΌμ•Ό ν•λ” κ·μ•½μ΄ μλ‹¤.
3. μ μ©ν• λ””ν΄νΈ λ©”μ„λ“λ¥Ό μ κ³µν•  μ μλ‹¤.



:notebook_with_decorative_cover: μ „μ© ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό μ‘μ„±ν•κΈ°λ΅ ν–λ‹¤λ©΄, μμ‹ μ΄ μ‘μ„±ν•λ” κ² λ‹¤λ¥Έκ²ƒλ„ μ•„λ‹ 'μΈν„°νμ΄μ¤'μ„μ„ λ…μ‹¬ν•΄μ•Ό ν•λ‹¤. μ•„μ£Ό μ£Όμν•΄μ„ μ„¤κ³„ν•΄μ•Ό ν•λ‹¤λ” λ»μ΄λ‹¤.



- EldestEntryRemovalFunction μΈν„°νμ΄μ¤μ— @FunctionalInterface μ• λ„ν…μ΄μ…μ΄ λ‹¬λ ¤ μμμ— μ£Όλ©ν•μ. μ΄ μ• λ„ν…μ΄μ…μ„ μ‚¬μ©ν•λ” μ΄μ λ” @Overrideλ¥Ό μ‚¬μ©ν•λ” μ΄μ μ™€ λΉ„μ·ν•λ‹¤. ν”„λ΅κ·Έλλ¨Έμ μλ„λ¥Ό λ…μ‹ν•λ” κ²ƒμΌλ΅ ν¬κ² μ„Έ κ°€μ§€ λ©μ μ΄ μλ‹¤.

1. ν•΄λ‹Ή ν΄λμ¤μ μ½”λ“λ‚ μ„¤λ… λ¬Έμ„λ¥Ό μ½μ„ μ΄μ—κ² κ·Έ μΈν„°νμ΄μ¤κ°€ λλ‹¤μ©μΌλ΅ μ„¤κ³„λ κ²ƒμ„μ„ μ•λ ¤μ¤€λ‹¤.
2. ν•΄λ‹Ή μΈν„°νμ΄μ¤κ°€ μ¶”μƒ λ©”μ„λ“λ¥Ό μ¤μ§ ν•λ‚λ§ κ°€μ§€κ³  μμ–΄μ•Ό μ»΄νμΌλκ² ν•΄μ¤€λ‹¤.
3. κ·Έ κ²°κ³Ό μ μ§€λ³΄μ κ³Όμ •μ—μ„ λ„κµ°κ°€ μ‹¤μλ΅ λ©”μ„λ“λ¥Ό μ¶”κ°€ν•μ§€ λ»ν•κ² λ§‰μ•„μ¤€λ‹¤.

κ·Έλ¬λ‹ **μ§μ ‘ λ§λ“  ν•¨μν• μΈν„°νμ΄μ¤μ—λ” ν•­μƒ @FunctionalInterface μ• λ„ν…μ΄μ…μ„ μ‚¬μ©ν•λΌ.**



π€λ§μ§€λ§‰μΌλ΅ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό APIμ—μ„ μ‚¬μ©ν•  λ•μ μ£Όμμ μ€ μ„λ΅ λ‹¤λ¥Έ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό κ°™μ€ μ„μΉμ μΈμλ΅ λ°›λ” λ©”μ„λ“λ“¤μ„ λ‹¤μ¤‘ μ •μν•΄μ„λ” μ• λλ‹¤. ν΄λΌμ΄μ–ΈνΈμ—κ² λ¶ν•„μ”ν• λ¨νΈν•¨λ§ μ•κ²¨μ¤„ λΏμ΄λ©°, λ¨νΈν•¨μΌλ΅ μΈν•΄ μ‹¤μ λ΅ λ¬Έμ κ°€ μΌμ–΄λ‚κΈ°λ„ ν•λ‹¤.



> ν•µμ‹¬ μ •λ¦¬
>
> μ΄μ  μλ°”λ„ λλ‹¤λ¥Ό μ§€μ›ν•λ‹¤. μ—¬λ¬λ¶„λ„ μ§€κΈλ¶€ν„°λ” APIλ¥Ό μ„¤κ³„ν•  λ• λλ‹¤λ„ μ—Όλ‘μ— λ‘μ–΄μ•Ό ν•λ‹¤λ” λ»μ΄λ‹¤. μ…λ ¥κ°’κ³Ό λ°ν™κ°’μ— ν•¨μν• μΈν„°νμ΄μ¤ νƒ€μ…μ„ ν™μ©ν•λΌ. λ³΄ν†µμ€ java.util.function ν¨ν‚¤μ§€μ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ κ°€μ¥ μΆ‹μ€ μ„ νƒμ΄λ‹¤. λ‹¨ ν”μΉλ” μ•μ§€λ§ μ§μ ‘ μƒλ΅μ΄ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό λ§λ“¤μ–΄ μ“°λ” νΈμ΄ λ‚μ„ μλ„ μμμ„ μμ§€ λ§μ.